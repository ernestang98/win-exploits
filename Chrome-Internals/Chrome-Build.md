# How to build d8.exe on Windows

### Steps

1. Download depot tools

2. Add depot tools path to the FRONT of your PATH environmental variable

3. Create DEPOT_TOOLS_WIN_TOOLCHAIN environmental variable and set it to 0

4. Create vs????_install variable and set it to the installation path to your MSVC

    - MSVC 2017 settings which was used in [Jack Halon's blog](https://jhalon.github.io/chrome-browser-exploitation-3/) allowed me to smoothly build d8.exes until 12.2.XXXX (may work for more versions but never tried, also you may have to uninstall/install older/newer Windows SDK versions). Does NOT work for latest d8 version which is 12.7.XXXX as of at this point in time (need to use MSVC 2022).

    - MSVC 2022 may not work for older builds of d8.exe but it certainly works for newer ones (it can be used to build 11.4.XXXX so with both MSVC 2022 and MSVC 2017, you should be able to build most V8s from 2018 to now (2024))

    - You may also need to change the version of depot tools itself based on the version of d8 you are building

        ```
        COMMIT_DATE=$(git show -s --format=%cd --date=format:'%Y-%m-%d')
        git checkout $(git rev-list -n 1 --before="$COMMIT_DATE" master)
        ```

5. Install the appropriate version of Windows SDK (when you attempt the next few steps, if you encounter tones of errors which will flag that you do not have the correct Windows SDK version downloaded, then you know that you don't have the correct Windows SDK version downloaded)

6. Fix any miscellaneous errors (such as incompatible python3 versions). Google/ChatGPT before sequentially resolving them

7. Run `gclient` (make sure no errors)

8. Run `mkdir v8 ; cd v8 ; fetch v8`

9. Run `cd v8 # your path should be something like C:\v8\v8`

10. Run `gclient sync -D`

11. Run `gn gen --ide=vs out\x64.debug` / `gn gen out\x64.debug`

12. Run x64 Native Tools Command Prompt and execute `cd C:\v8\v8\out\x64.debug` 

13. Run `msbuild all.sln`

    - Run `ninja -C out\x64.debug d8` or `autoninja -C out\x64.debug d8` to just build d8

### References

- []

- []

- []


https://chromium.googlesource.com/chromium/src/+/main/docs/android_build_instructions.md

https://www.chromium.org/developers/gn-build-configuration/

https://andreasch.com/2019/01/29/build-chromium-android/

https://gist.github.com/revmischa/cd299db577af73965ef96ee6dbd1deca

https://github.com/Ravbug/chromiumbuild/blob/master/chromiumbuild_win.bat

https://github.com/Hibbiki/chromium-win64

https://github.com/porkycode/Chromium-Windows-Build

https://github.com/thlorenz/chromium/blob/master/building.md

https://github.com/thlorenz/chromium/blob/master/README.md

https://gist.github.com/kennwhite/b05fcdd2161688c1e859f962ec90c4f4

https://github.com/chromium/chromium/blob/main/docs/android_build_instructions.md

https://www.chromium.org/developers/gn-build-configuration/

https://sinclairinat0r.com/2019/04/29/building-chromium-on-windows-from-source

https://gist.github.com/qrealka/0aa39d850310d02ced2dd71a95ae6b0f

https://chromium.googlesource.com/external/github.com/v8/v8.wiki/+/8c0be5e888bda68437f15e2ea9e317fd6229a5e3/Building-with-GN.md

https://v8.dev/docs/build

https://chromium.googlesource.com/chromium/src/+/main/docs/windows_build_instructions.md

https://chromium.googlesource.com/chromium/src/+/main/docs/linux/build_instructions.md

https://chromium.googlesource.com/chromium/src/+/main/docs/android_build_instructions.md

https://stackoverflow.com/questions/35979642/what-is-git-tag-how-to-create-tags-how-to-checkout-git-remote-tags

### Building d8 on Ubuntu

- clone

- fetch v8

- add target_os = ['android', 'unix'] 

- ./build/install-build-deps.sh --android

- ./build/install-build-deps.sh 

- gclient sync

- can start building

- git checkout + gclient sync

- ./tools/dev/gm.py x64.release

- gn gen out/x64.release

https://v8.dev/docs/cross-compile-arm

- lowest possible build is 11.0.1? 776298987617eb544c5ef03bc8e67c7f2d0fdcbc Aug 9 20:23:54 2024 